# Example NotebookValidationJob for private repository with HTTPS authentication
# Based on ADR-009: Secret Management and Git Credentials
#
# Prerequisites:
#   1. Create Git credentials secret:
#      kubectl apply -f config/samples/git-credentials-https.yaml
#   2. Apply this NotebookValidationJob:
#      kubectl apply -f config/samples/mlops_v1alpha1_notebookvalidationjob_private.yaml

apiVersion: mlops.mlops.dev/v1alpha1
kind: NotebookValidationJob
metadata:
  labels:
    app.kubernetes.io/name: jupyter-notebook-validator-operator
    app.kubernetes.io/managed-by: kustomize
  name: notebookvalidationjob-private-https
  namespace: jupyter-notebook-validator-operator
spec:
  notebook:
    git:
      url: https://github.com/tosin2013/jupyter-notebook-validator-test-notebooks.git
      ref: main
      credentialsSecret: git-https-credentials  # Reference to HTTPS credentials secret
    path: notebooks/tier1-simple/01-hello-world.ipynb

  podConfig:
    containerImage: quay.io/jupyter/scipy-notebook:latest
    serviceAccountName: jupyter-notebook-validator-runner
    resources:
      requests:
        memory: "512Mi"
        cpu: "500m"
      limits:
        memory: "1Gi"
        cpu: "1000m"
    env:
      - name: JUPYTER_ENABLE_LAB
        value: "yes"

  timeout: "30m"

---
# Example NotebookValidationJob for private repository with SSH authentication
apiVersion: mlops.mlops.dev/v1alpha1
kind: NotebookValidationJob
metadata:
  labels:
    app.kubernetes.io/name: jupyter-notebook-validator-operator
    app.kubernetes.io/managed-by: kustomize
  name: notebookvalidationjob-private-ssh
  namespace: jupyter-notebook-validator-operator
spec:
  notebook:
    git:
      url: git@github.com:tosin2013/jupyter-notebook-validator-test-notebooks.git
      ref: main
      credentialsSecret: git-ssh-credentials  # Reference to SSH credentials secret
    path: notebooks/tier1-simple/01-hello-world.ipynb

  podConfig:
    containerImage: quay.io/jupyter/scipy-notebook:latest
    serviceAccountName: jupyter-notebook-validator-runner
    resources:
      requests:
        memory: "512Mi"
        cpu: "500m"
      limits:
        memory: "1Gi"
        cpu: "1000m"
    env:
      - name: JUPYTER_ENABLE_LAB
        value: "yes"

  timeout: "30m"

